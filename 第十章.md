# 《代码大全2》第十章 “使用变量的一般事项” 读书笔记

## 10.1 数据认知
``` 感想
感想：
      这一节是一个认知测试，自测了一下17分，符合中级程序员的标准~
      作者很皮，在测试里面加入了杜撰的选项，用来测“诚实”
```
## 10.2 轻松掌握变量定义
* 隐式变量声明对于任何一种语言来说都是最具危险性的特性之一（变量混淆）
``` 感想
感想：
      隐式变量声明确实会带来一些难以理解的问题，比如全局变量占用名称后，局部使用同名变量可能期望生命一个同名的局部变量，却会使用全局的变量。显示变量生命可以让编译器来发现拼写错误的问题。
```
## 10.3 变量初始化原则
变量不初始化或者错误的初始化可能会引入一系列的问题，建议：
* 在声明变量的时候初始化
* 在靠近变量第一次使用的位置初始化
* 想情况下,在靠近第一次使用变量的位置声明和定义该变量
* 在可能的情况下使用fina或者const（可以防止该变量在初始化之后再被赋值）
* 特别注意计数器和累加器
* 在类的构造函数里初始化该类的数据成员
* 检查是否需要重新初始化
* 一次性初始化具名常量;用可执行代码来初始化变量
* 使用编译器设置来自动初始化所有变量
* 利用编译器的警告信息
* 检查输入参数的合法性
* 使用内存访问检查工具来检查错误的指针
* 在程序开始时初始化工作过内存
``` 感想
感想：
      Qt的数据类型会自动初始化，但是应该警惕不会自动初始化的数据类型。
```
## 10.4 作用域

### 使变量引用局部化
      避免不当地修改了这个变量,或者阅读代码的人可能会忘记该变量应有的值——主要好处是提高程序的可读性
### 尽可能缩短变量的“存活”时间

1. 减小攻击窗口
2. 使你能对自己的代码有更准确的认识
3. 少了初始化错误的可能
4. 代码容易拆分和重构
5. 更强的可读性

### 减小作用域的一般原则

1. 在循环开始之前再去初始化该循环里使用的变量,而不是在该循环所属的子程序的开始处初始化这些变量
2. 直到变量即将被使用时再为其赋值
3. 把相关语句放到一起
4. 把相关语句组提取成单独的子程序
5. 开始时采用最严格的可见性,然后根据需要扩展变量的作用域

### 有关缩小变量作用域的说明

“方便性”和“智力可管理性”两种理念之间的区别,归根结底来源于侧重写程序还是读程序之间的区别。使作用域最大化可能真的会让程序写起来比较容易,但相对于子程序功能划分明确的程序,一个允许任何其子程序在任何时间使用任何变量的程序是更难于理解的。对于这种程序,你不能只去理解一个子程序;你还必须要理解其他所有使用了相同全局数据的子程序才行。这种程序无论阅读、调试还是修改起来都很困难。

``` 感想
感想：
      全局变量虽然在写代码的时候很方便，但是对于阅读的人来说需要阅读更多的代码才能理解用意。也不方便重构，可移植性会下降。
      类中的私有成员变量也是一样的，如果一个类特别大，这个成员变量可能在各种意想不到的地方被修改，给阅读造成困扰。
      如非必要尽可能使用作用域小的手段解决问题。
```
## 10.5 持续性
“持续性”是对一项数据的生命期的另一种描述
“持续性”从短到长：  
1. 特定代码段或子程序的生命期： 循环里声明的变量
2. 只要你允许,它就会持续下去：new出来的变量
3. 程序的生命周期：static变量
4. 永久持续：存到数据库里的变量

合理的“持续性”能够避免在一个变量正常的生命期结束之后访问它的数据，为了确保生命周期有如下措施：

1. 调试代码或者断言判断变量取值是否合理
2. 准备抛弃变量时给它们赋上“不合理的数值”，例如删除一个指针后把它的值设为null
3. 编写代码时要假设数据并没有持续性
4. 养成在使用所有数据之前声明和初始化的习惯
   
## 10.6 绑定时间

1. 编码时(使用神秘数值)
2. 编译时(使用具名常量)
3. 加载时(从 Windows注册表、Java属性文件等外部数据源中读取数据)
4. 对象实例化时(例如在每次窗体创建的时候读取数据)
5. 即时(例如在每次窗体重绘的时候读取数据)
   绑定时间越早灵活性就会越差,但复杂度也会越低

## 10.7 数据类型和控制结构之间的关系

1. 序列型数据翻译为程序中的顺序语句：如果你从文件中读取了员工的姓名、社会安全号码、住址、电话号码和年龄
2. 选择型数据翻译为程序中的if和case语句
3. 迭代型数据翻译成程序中的for、 repeat、 while等循环结构
   
## 10.8 为变量指定单一用途

1. 每个变量只用于单一用途
2. 避免让代码具有隐含含义
3. 避免让代码具有隐含含义