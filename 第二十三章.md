# 《代码大全2》第二十三章 “调试” 读书笔记

调试是确定错误根本原因并纠正此错误的过程

## 23.1调试概述

### 调试在软件质量中所扮演的角色
同测试一样,调试本身并不是改进代码质量的方法,而是诊断代码缺陷的一种方法。软件的质量必须从开始逐步建立开发高质量软件产品的最佳途径是精确描述需求,完善设计,并使用高质量的代码编写规范。调试只是迫不得已时采用的手段。

### 调试效率的巨大差异
经验丰富的程序员找出缺陷所用的时间大约只是缺乏经验的程序员们的1/20

### 让你有所收获的缺陷

程序中的错误为你提供了学习很多东西的绝好机会：
* 理解你正在编写的程序
* 明确你犯了哪种类型的错误
* 从代码阅读者的角度分析代码质量
* 审视自己解决问题的方法
* 审视自己修正缺陷的方法

调试其实是一片极其富饶的土地,它孕育着你进步的种子

### 一种效率低下的调试方法
错误的调试方法：猜测、不理解问题本身、用最唾手可得的方式修正错误、迷信式调试

## 23.2寻找缺陷
调试包括了寻找缺陷和修正缺陷。寻找缺陷——并且理解缺陷通常占到了整个调试工作的90%

### 科学的调试方法

一种寻找缺陷的有效方法：
1. 将错误状态稳定下来（bug要可重复，可稳定复现）
2. 确定错误的来源
      a. 收集产生缺陷的相关数据  
      b. 分析所收集的数据,并构造对缺陷的假设  
      c. 确定怎样去证实或证伪这个假设,可以对程序进行测试或是通过检查代码  
      d. 对假设做出最终结论  
3. 修补缺陷
4. 对所修补的地方进行测试
5. 查找是否还有类似的错误

### 寻找缺陷的一些小建议

* 在构造假设时考虑所有的可用数据
* 提炼产生错误的测试用例
* 自己的单元测试族中测试代码
* 采用多种不同的方法重现错误
* 用更多的数据生成更多的假设
* 利用否定性测试用例的结果
* 对可能的假设尝试头脑风暴
* 把需要尝试的事情逐条列出
* 缩小嫌疑代码的范围
* 对之前出现过缺陷的类和子程序保持警惕
* 检查最近修改过的代码
* 扩展嫌疑代码的范围
* 增量式集成
* 同其他人讨论问题（小黄鸭调试法！组织语言的时候就理清了，最近改的一个bug就用的这个）
* 抛开问题,休息一下

### 蛮力调试
快速尝试可能解决，蛮力调试（包括直接重写）往往会奏效。花费2个小时去调试一个30分钟就能写出来的代码就是坚持快速尝试的后果，有的时候蛮力调试更有效。

### 语法错误

* 不要过分信任编译器信息中的行号
* 不要迷信编译器信息
* 不要轻信编译器的第二条信息（先看第一条！）
* 分而治之
* 找出没有配对的注释或者引号

## 23.3修正缺陷
* 在动手之前先要理解问题
* 理解程序本身,而不仅仅是问题
* 验证对错误的分析
* 放松一下（压力大匆忙提交可能会引入新的问题，这条对于系统测试凌晨改bug很适用，欲速则不达）
* 保存最初的源代码（方便回滚）
* 治本,而不是治标
* 修改代码时一定要有恰当的理由
* 一次只做一个改动
* 检查自己的改动
* 增加能暴露问题的单元测试
* 搜索类似的缺陷
  
## 23.4调试中的心理因素

对熟悉东西的先入为主的判断可能是错误的，需要保持警惕

## 23.5调试工具
* 源代码比较工具
* 编译器的警告消息
* 增强的语法检查和逻辑检查
* 执行性能剖测器
* 测试框架/脚手架
* 调试器
  
``` 读后感
读后感：
      调试技巧能够大幅提高定位问题的速度，我在第一次知道调试时左侧的箭头可以前后拖动的时候感觉打开了新世界的大门，从此很多场景不用因为一不小心错过了重新操作一遍复现路径了，类似的还有条件断点。
```  
