# 《代码大全2》第十六章 “控制循环” 读书笔记

“循环”是一个非正式的术语,用来指代任意一种迭代控制结构(iterative control structure)任一能够导致应用程序反复执行一段代码的结构。

## 16.1 选择循环的种类
1. 计数循环（执行的次数是一定的）
2. 连续求值的循环（迭代时检查是否应该结束）
3. 无限循环（心脏起搏器中就会用）
4. 迭代器循环（对容器类里面的每个元素执行）

* 灵活度：  
      严格——循环执行的次数是一定的,  
      灵活——在每次迭代的时候检查循环有没有完成 

* 检查循环是否执行完毕的位置：  
      循环的开始，循环中的代码不一定被执行
      中间，检查之前的代码一定被执行
      结尾处，代码至少执行一次
### 什么时候使用 while循环
如果你预先并不知道循环要迭代多少次,那么就使用 while循环  
* while在开始时检查条件
* do-while在结束时检查条件
### 什么时候用带退出的循环

#### 正常的带退出循环
在检查前的代码至少要执行一次的情况使用带退出的循环  
关注细节：  
* 把所有的退出条件放在一处，易读
* 不直接支持带退出循环的语言里使用带退出循环时，用注释来阐明操作意图

#### 非正常的带退出循环  
用goto中途闯进一个循环（恐怖）

### 何时使用for循环
需要简单的、固定次数的循环
* 不要在内部修改下标影响循环
* 在头部写好循环条件后，内部无需关注循环控制问题

### 何时使用 foreach循环
很适用于对数组或者其他容器的各项元素执行操作，它的优势在于消除了循环内务处理算术,从而也就消除了任何由循环控制算术导致出错的可能性。

``` 感想
感想：
      使用循环是程序员的基本功之一，foreach用起来很方便，也能够提高代码的可读性，使阅读者理解编码者要对容器中每个元素进行操作。目前使用的foreach是Qt提供的；std库提供了for_each模板函数；个人比较喜欢使用C++11标准中提供了标准的for(auto item:container){;}。
```  
## 16.2循环控制
循环会出显得错误：
* 忽略或错误地对循环执行初始化
* 忽略了对累加变量或其他与循环有关的变量执行初始化
* 不正确的嵌套
* 不正确的循环终止
* 忽略或者错误地增加了循环变量的值
* 用不正确的循环下标访问数组元素
阻止上述错误的策略：
* 减少能影响该循环各种因素的数量
* 把循环内部当做一个子程序看待
``` 感想
感想：
      “当做一个子程序看待”，但不是真的循环里放一个子程序，会带来没办法break的问题，C++11中std::for_each()函数就有这个问题，循环体在lambda表达式中，不能提前终止循环。
```
### 进入循环 
* 只从一个位置进入循环
* 把初始化代码紧放在循环前面（就近原则，易于修改）
* 用 while(true)表示无限循环（想象一下用在心脏起搏器中的场景，不能使用一个大数）
* 在适当的情况下多使用for循环（控制集中，易于修改）
* 在 while循环更适用的时候,不要使用for循环（for循环头部只放循环控制语句）
### 处理好循环体
* 用“{”和“}”把循环中的语句括起来（增加可读性）
* 避免空循环（避免循环内部没有语句，功能在控制时执行）
* 一个循环只做一件事（除非影响效率）
### 退出循环
* 设法确认循环能够终止
* 使循环终止条件看起来很明显
* 不要为了终止循环而胡乱改动for循环的下标（for循环内部不要控制循环本身）
* 避免出现依赖于循环下标最终取值的代码（下标作用域超出循环范围）
* 考虑使用安全计数器（防御以避免死循环）
### 提前退出循环
* continue不会让程序从循环退出,而是让程序跳过循环体的余下部分,从该循环的下一次迭代的开始位置继续执行。而break会直接退出循环。
* 考虑在 while循环中使用 break语句而不用布尔标记（增加可读性）
* 在循环开始处用 continue进行判断（可以避免整个循环放在if里面）
* 使用 break和 continue时要小心谨慎（增加了复杂度，除非必要尽量少用）
### 检查端点
脑海中模拟并计算，确保边界条件正确
``` 感想
      感想：低效的程序员会通过尝试写出能够正确工作的代码，不知道代码为什么正确，后面就更不知道为什么，为什么出错了
```
### 使用循环变量
* 用整数或者枚举类型表示数组和循环的边界（别用浮点数）
* 在嵌套循环中使用有意义的变量名来提高其可读性
* 用有意义的名字来避免循环下标串话（避免用错下标）
* 把循环下标变量的作用域限制在本循环内

### 循环应该有多长
* 循环要尽可能地短,以便能够一目了然
* 把嵌套限制在3层以内
* 把长循环的内容移到子程序里
* 要让长循环格外清晰
``` 感想
感想：
      通过这一节的阅读，我发现编程语言对循环的限制确实不多，还能够写出这么多奇形怪状的循环，作者始终在强调避免使用这些奇怪的方式，提高代码的可读性和可维护性。事实上循环应该有的样子已经非常深入人心了，奇怪的写法不单读起来头大，写起来也很别扭的。目前只见过foreach循环容器的过程中删除容器元素一种比较难受的情况下。
```  
## 16.3轻松创建循环由内而外
先写单一情况，再在外面套上循环
## 16.4循环和数组的关系
略

``` 读后感
读后感：
      使用主流的方式使用循环，不要写“聪明”代码，保证代码的可读性和可维护性。
``` 